(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99775d0c","chunk-6cf7b916","chunk-2c9e12e0","chunk-03c4c1a6"],{"04f7":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container",class:t.wrapperClass},[a("div",{staticClass:"modal-header"},[t._t("header")],2),a("div",{staticClass:"modal-body"},[t._t("body")],2),a("div",{staticClass:"modal-footer"},[t._t("footer")],2)])])])])},n=[],i=(a("9c86"),{name:"modal",data:function(){return{modal:!1}},props:{big:{type:Boolean,default:!1}},mounted:function(){var t=this;document.addEventListener("keydown",function(e){27==e.keyCode&&t.$emit("onClose")})},computed:{wrapperClass:function(){return this.big?"big-modal":""}}}),o=i,r=(a("d93c"),a("2877")),l=Object(r["a"])(o,s,n,!1,null,null,null);l.options.__file="modal.vue";e["default"]=l.exports},"2ca8":function(t,e,a){"use strict";var s=a("e266"),n=a.n(s);n.a},"80e1":function(t,e,a){"use strict";var s=a("c63d"),n=a.n(s);n.a},"84eb":function(t,e,a){},"9c86":function(t,e,a){"use strict";a("386b")("big",function(t){return function(){return t(this,"big","","")}})},a1fc:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("vue-dropzone",{ref:"dropzoneRef",attrs:{id:"dropzone",options:t.options,useCustomSlot:!!t.defaultImg}},[a("div",{staticClass:"dropzone-bg",style:t.bg,on:{mouseover:function(e){t.hoverSlot=!0},mouseleave:function(e){t.hoverSlot=!1}}},[a("transition",{attrs:{name:"fade"}},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.hoverSlot,expression:"hoverSlot"}],staticClass:"glyphicon glyphicon-pencil"})])],1)]),t.file?a("modal",{on:{onClose:function(e){t.file=!1}}},[t.onlyImg?t._e():a("template",{slot:"header"},[a("div",{staticClass:"col text-center"},[t._v("\n        "+t._s(t.file.name)+"\n      ")])]),a("template",{slot:"body"},[a("div",{staticClass:"modal-body text-center"},[a("img",{attrs:{src:t.file.url.medium}}),t._l(t.file.url,function(e,s){return t.onlyImg?t._e():a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-3"},[t._v("\n            "+t._s(t._f("translate")("uploader."+s))+" :\n          ")]),a("div",{staticClass:"col-md-9 text-center"},[a("a",{staticClass:"btn btn-info btn-micro",attrs:{target:"_blank",href:e},domProps:{innerHTML:t._s(t.$t("uploader.open"))}}),a("button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:"file.url."+s,expression:"`file.url.${index}`",arg:"copy"}],staticClass:"btn btn-primary btn-micro",staticStyle:{"margin-right":"10px"},domProps:{innerHTML:t._s(t.$t("uploader.copy"))}})])])})],2)]),a("template",{slot:"footer"},[a("button",{staticClass:"btn btn-info btn-micro",domProps:{innerHTML:t._s(t.$t("uploader.close"))},on:{click:function(e){t.file=!1}}}),t.allowDelete?a("button",{staticClass:"btn btn-danger btn-micro",domProps:{innerHTML:t._s(t.$t("uploader.delete"))},on:{click:t.deleteFile}}):t._e()])],2):t._e()],1)},n=[],i=(a("7f7f"),a("f386"),a("c5f6"),a("04f7")),o=a("d1d4"),r=a("92c3"),l=a.n(r),c=(a("1e3f"),{name:"uploader",data:function(){return{file:!1,options:{},loading:!1,deleting:!1,hoverSlot:!1}},props:{hasSlot:{type:Boolean,defalut:!1},apiUrl:{type:String,required:!0},deleteApiUrl:{type:String,default:""},images:{type:Function,required:!0},maxFiles:{type:Number,default:100},allowDelete:{type:Boolean,default:!0},onlyImg:{type:Boolean,default:!1},placeholder:String,defaultImg:String},components:{Modal:i["default"],vueDropzone:l.a},created:function(){var t=this,e=this.$store.getters.token;this.options={timeout:5e3,maxFilesize:4,uploadMultiple:!1,maxFiles:this.maxFiles,acceptedFiles:".jpeg,.jpg,.png,.gif",url:"api/".concat(this.apiUrl),headers:{Authorization:"Bearer ".concat(e)},dictFileTooBig:this.$i18n.translate("file.big"),dictDefaultMessage:this.placeholder||this.$i18n.translate("file.upload"),renameFile:function(e){return t.renameFile(e)},success:function(e,a){return t.onSuccess(e,a)},error:function(e,a,s){return t.onError(e,a,s)}}},mounted:function(){this.init()},beforeDestroy:function(){this.$refs.dropzoneRef.destroy()},computed:{bg:function(){var t=this.defaultImg;return"background-image: url('".concat(t,"')")}},methods:{init:function(){var t=this,e=this.images();e.map(function(e){return t.$refs.dropzoneRef.manuallyAddFile(e,e.url.small)}),this.addOnClick()},reInit:function(t){this.$emit("onChange",t),this.$refs.dropzoneRef.removeAllFiles(),this.init()},addOnClick:function(){var t=this;this.$refs.dropzoneRef.dropzone.files.map(function(e){e.previewElement.addEventListener("click",function(){t.file=e})})},renameFile:function(t){var e=new Date,a=e.getTime();return a+"-"+t.name},onSuccess:function(t,e){this.reInit(e)},onError:function(t,e,a){this.$refs.dropzoneRef.removeFile(t),this.$store.dispatch("addToastMessage",{text:e})},deleteFile:function(){if(this.allowDelete&&!this.deleting){var t=this,e=this.file;this.$swal({type:"warning",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonColor:"#3085d6",title:t.$i18n.translate("alert.sure"),text:t.$i18n.translate("alert.sure_text"),cancelButtonText:t.$i18n.translate("alert.cancel"),confirmButtonText:t.$i18n.translate("alert.confirm")}).then(function(a){a.value&&(t.deleting=!0,o["a"].post(t.deleteApiUrl?t.deleteApiUrl:"".concat(t.apiUrl,"/").concat(e.id)).then(function(e){t.reInit(e),t.$swal({type:"success",title:t.$i18n.translate("uploader.deleted"),text:t.$i18n.translate("uploader.deleted_text"),confirmButtonText:t.$i18n.translate("alert.confirm")})}).finally(function(){t.file=!1,t.deleting=!1}))})}}}}),d=c,u=(a("2ca8"),a("2877")),p=Object(u["a"])(d,s,n,!1,null,null,null);p.options.__file="uploader.vue";e["default"]=p.exports},c63d:function(t,e,a){},d73e:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-elements"},[a("div",{staticClass:"row"},[a("Editor",{attrs:{editor_id:t.tab,mode:"classic"},on:{editor:t.handleEditor}})],1)])},n=[],i=(a("cadf"),a("551c"),a("097d"),a("38c1")),o={name:"update-tab",data:function(){return{editor:null}},props:{tab:{type:String,required:!0},content:{type:String,required:!0}},components:{Editor:i["default"]},methods:{handleEditor:function(t){this.editor=t,this.$emit("content",this.editor),this.editor.setContents(this.content)},update:function(){data={tab:this.tab,content:this.content},this.$emit("onUpdate",data)}}},r=o,l=(a("80e1"),a("2877")),c=Object(l["a"])(r,s,n,!1,null,null,null);c.options.__file="tab.vue";e["default"]=c.exports},d93c:function(t,e,a){"use strict";var s=a("84eb"),n=a.n(s);n.a},e266:function(t,e,a){},eb4d:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.loaded?a("div",{staticClass:"form-elements"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("vuestic-widget",{attrs:{headerText:t._f("translate")("menu.weeks.update")}},[a("div",{staticClass:"row row-reverse mt-5"},[a("div",{staticClass:"col-8"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group with-icon-right",class:{"has-error":t.errors.has("name")}},[a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{id:"name",name:"name",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("name"),expression:"errors.has('name')"}],staticClass:"fa fa-exclamation-triangle icon-right input-icon"}),a("label",{staticClass:"control-label",attrs:{for:"name"}},[t._v(t._s(t._f("translate")("week.name")))]),a("i",{staticClass:"bar"}),a("small",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("name"),expression:"errors.has('name')"}],staticClass:"help text-danger"},[t._v(t._s(t.errors.first("name"))+"\n                    ")])])])]),a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group with-icon-right",class:{"has-error":t.errors.has("keywords")}},[a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{id:"keywords",name:"keywords"},domProps:{value:t.keywords},on:{input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("keywords"),expression:"errors.has('keywords')"}],staticClass:"fa fa-exclamation-triangle icon-right input-icon"}),a("label",{staticClass:"control-label",attrs:{for:"keywords"}},[t._v(t._s(t._f("translate")("week.keywords")))]),a("i",{staticClass:"bar"}),a("small",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("keywords"),expression:"errors.has('keywords')"}],staticClass:"help text-danger"},[t._v(t._s(t.errors.first("keywords"))+"\n                    ")])])])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"col-md-12",attrs:{id:"excerpt",placeholder:t._f("translate")("week.description")},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})])])]),a("div",{staticClass:"col-4"},[a("div",{staticClass:"row"},[a("Uploader",{attrs:{maxFiles:1,apiUrl:t.apiUrl,images:t.getImage,placeholder:t._f("translate")("week.image")},on:{onChange:t.reInitImage}})],1)])]),a("div",{staticClass:"row mt-2"},[a("Editor",{on:{editor:t.handleEditor}})],1),a("div",{staticClass:"row row-reverse mt-2"},[a("h3",{staticClass:"pt-2 col-12 text-right"},[t._v(t._s(t.$t("week.tabs")))]),a("ul",{staticStyle:{direction:"rtl","text-align":"right"}},t._l(t.tabs,function(e,s){return a("li",[a("a",{staticClass:"text-info",on:{click:function(e){t.editTab(s)}}},[t._v(t._s(e))])])}))]),a("div",{staticClass:"row"},[a("div",{staticClass:"col col text-center mt-4"},[a("button",{staticClass:"btn btn-success",on:{click:t.update}},[t._v("\n              "+t._s(t._f("translate")("buttons.update"))+"\n            ")])])])]),t.tab?a("modal",{on:{onClose:function(e){t.tab=!1}}},[a("template",{slot:"header"},[a("div",{staticClass:"col text-center"},[t._v("\n            "+t._s(t.tabs[t.tab])+"\n          ")])]),a("template",{slot:"body"},[a("Tab",{attrs:{week:t.week.id,tab:t.tab,content:t.getTabContent()},on:{content:t.handleTabContent}})],1),a("template",{slot:"footer"},[a("div",{staticClass:"col text-center"},[a("button",{staticClass:"btn btn-info btn-micro",domProps:{innerHTML:t._s(t.$t("buttons.cancel"))},on:{click:t.closeTab}}),a("button",{staticClass:"btn btn-danger btn-micro",domProps:{innerHTML:t._s(t.$t("buttons.update"))},on:{click:t.updateTabContent}})])])],2):t._e()],1)])]):a("loading")},n=[],i=(a("7514"),a("7f7f"),a("96cf"),a("cb0c")),o=a("d73e"),r=a("d1d4"),l=a("240f"),c=a("04f7"),d=a("38c1"),u=a("a1fc"),p={name:"update-week",data:function(){return{week:{},id:0,name:"",keywords:"",description:"",abstract:"",tab:!1,tabContent:"",tabs:[],editor:null,loaded:!1,apiUrl:"weeks/"+this.$route.params.id+"/upload"}},components:{Tab:o["default"],Modal:c["default"],Editor:d["default"],Loading:l["default"],Uploader:u["default"]},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r["a"].get("weeks/".concat(this.$route.params.id));case 3:return e=t.sent,t.next=6,r["a"].post("weeks/tabs");case 6:a=t.sent,this.week=e.data,this.id=e.data.id,this.name=e.data.name,this.keywords=e.data.keywords,this.description=e.data.description,this.tabs=a,this.loaded=!0,t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),this.$store.dispatch("addToastMessage",{text:this.$t("errors.".concat(t.t0.data.status_code))}),this.$router.push({name:"weeks"});case 20:case"end":return t.stop()}},t,this,[[0,16]])}));return function(){return t.apply(this,arguments)}}(),methods:{handleEditor:function(t){this.editor=t,this.editor.setContents(this.week.abstract)},editTab:function(t){this.tab=t},closeTab:function(){this.tab=!1,this.tabContent=""},getTabContent:function(){var t=this,e=this.week.tabs.filter(function(e){return e.tab===t.tab}).length?this.week.tabs.find(function(e){return e.tab===t.tab}).content:"";return e},updateTabContent:function(){var t=this,e={week_id:this.week.id,tab:this.tab,content:this.tabContent.getContents()};r["a"].post("weeks/tab",e).then(function(e){t.$store.dispatch("addToastMessage",{text:t.$t("week.updated"),type:"success"}),t.closeTab(),t.week=e.data}).catch(function(e){t.$store.dispatch("addToastMessage",{text:e.data.errors.content[0]})})},handleTabContent:function(t){this.tabContent=t},getImage:function(){var t=this.week.image?[this.week.image.data]:[];return t},reInitImage:function(t){this.week=t.data},update:function(){var t=this;this.$validator.validateAll().then(function(e){if(e){var a={name:t.name,keywords:t.keywords,description:t.description,abstract:t.editor.getContents()};r["a"].put("weeks/".concat(t.id),a).then(function(e){t.$store.dispatch("addToastMessage",{text:t.$t("week.updated"),type:"success"}),t.$router.push({name:"weeks"})}).catch(function(e){t.$store.dispatch("addToastMessage",{text:t.$t("errors.any"),error:e})})}})}}},f=p,m=a("2877"),h=Object(m["a"])(f,s,n,!1,null,null,null);h.options.__file="update.vue";e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-99775d0c.442e359b.js.map