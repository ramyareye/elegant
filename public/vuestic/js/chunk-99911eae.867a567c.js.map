{"version":3,"sources":["webpack:///./src/view/consults/update.vue?b2b2","webpack:///src/view/consults/update.vue","webpack:///./src/view/consults/update.vue?1155","webpack:///./src/view/consults/update.vue","webpack:///./src/view/consults/update.vue?cddc"],"names":["render","_vm","this","_h","$createElement","_c","_self","loaded","staticClass","attrs","headerText","setTitle","staticStyle","direction","domProps","innerHTML","_s","question","ref","height","chatHeight","value","chatMessages","statuses","attachments","on","input","newMessage","update","updateMessage","delete","deleteMessage","margin-left","click","back","_v","_f","staticRenderFns","updatevue_type_script_lang_js_","name","data","consult","title","category_id","writer_id","status","topic_privacy","closed_at","answers","writer","components","Loading","Chat","chat","created","_created","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","request","wrap","_context","prev","next","Api","get","concat","$route","params","id","sent","post","init","t0","$store","dispatch","text","vue_esm","i18n","translate","status_code","$router","push","stop","apply","arguments","methods","map","answer","content","yours","date","time","created_at_time","msg","_this","put","then","response","$refs","chatbox","clear","catch","error","_ref","_this2","updateId","_this3","$swal","type","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","result","message","computed","len","length","consults_updatevue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_update_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_update_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"vuestic/js/chunk-99911eae.867a567c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (!_vm.loaded)?_c('loading'):_c('div',{staticClass:\"form-elements\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-12\"},[_c('vuestic-widget',{attrs:{\"headerText\":_vm.setTitle()}},[_c('div',{staticClass:\"row well mt-1\",staticStyle:{\"direction\":\"rtl\"},domProps:{\"innerHTML\":_vm._s(_vm.question)}}),_c('div',{staticClass:\"row text-right\"},[_c('div',{staticClass:\"col chat-holder\"},[_c('chat',{ref:\"chatbox\",attrs:{\"height\":_vm.chatHeight,\"value\":_vm.chatMessages,\"statuses\":_vm.statuses,\"attachments\":_vm.attachments},on:{\"input\":_vm.newMessage,\"update\":_vm.updateMessage,\"delete\":_vm.deleteMessage}})],1)]),_c('div',{staticClass:\"row mt-5\"},[_c('div',{staticClass:\"col text-center\"},[_c('button',{staticClass:\"btn btn-warning\",staticStyle:{\"margin-left\":\"5px\"},on:{\"click\":_vm.back}},[_vm._v(\"\\n                \"+_vm._s(_vm._f(\"translate\")('buttons.back'))+\"\\n              \")])])])])],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<loading v-if=\"!loaded\"/>\n  <div class=\"form-elements\" v-else>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <vuestic-widget :headerText=\"setTitle()\">\n\n          <div class=\"row well mt-1\" v-html=\"question\" style=\"direction: rtl;\"></div>\n          <!-- <div class=\"row mb-3 text-right\">            \n            <div class=\"col\">\n              <strong>{{'consult.question' | translate}}</strong>\n              \n            </div>\n          </div> -->\n\n          <div class=\"row text-right\">            \n            <div class=\"col chat-holder\">\n              <!-- <strong>{{'consult.answers' | translate}}</strong> -->\n              <chat \n                :height=\"chatHeight\"\n                :value=\"chatMessages\"\n                @input=\"newMessage\"\n                @update=\"updateMessage\"\n                @delete=\"deleteMessage\"\n                :statuses=\"statuses\"\n                :attachments=\"attachments\"\n                ref=\"chatbox\"\n              ></chat>\n            </div>            \n          </div>\n\n          <div class=\"row mt-5\">\n            <div class=\"col text-center\">\n              <!-- <button class=\"btn btn-success\"  @click=\"update\">\n                {{'buttons.update' | translate}}\n              </button> -->\n              <button class=\"btn btn-warning\" style=\"margin-left: 5px;\" @click=\"back\">\n                {{'buttons.back' | translate}}\n              </button>\n            </div>\n          </div>\n        </vuestic-widget>        \n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import Vue from 'vue'\n  import api from 'src/packages/Api'\n\n  import Chat from 'view/components/chat'\n  import Loading from 'partials/Loading'\n\n  export default {\n    name: 'update-consult',\n    data () {\n      return {\n        consult: {},\n        \n        title: '',\n        question: '',\n        category_id: '',\n        writer_id: '',\n        status: 'askedByUser',\n        topic_privacy: 'public',\n        closed_at: '',\n        answers: [],\n        attachments: [],\n        writer: {},\n        chatMessages: [],\n        statuses: [],\n\n        loaded: false\n      }\n    },\n    components: {\n      Loading,\n      Chat\n    },\n    async created () {\n      try {\n        const request = await api.get(`consults/${this.$route.params.id}`)\n        const statuses = await api.post('consults/status')\n\n        this.init(request.data)\n\n        this.statuses = statuses\n        this.loaded = true\n      } catch(error) {\n        this.$store.dispatch('addToastMessage',\n          { text: Vue.i18n.translate(`errors.${error.status_code}`) }\n        )\n        this.$router.push({ name: 'consults' })\n      }\n    },\n    methods: {\n      init (consult) {\n        this.consult = consult\n        this.title = consult.title\n        this.question = consult.question\n        this.category_id = consult.category_id\n        this.writer_id = consult.writer_id\n        this.status = consult.status\n        this.topic_privacy = consult.topic_privacy\n        this.closed_at = consult.closed_at\n        this.writer = consult.writer.data\n        this.answers = consult.answers.data\n        this.attachments = consult.attachments.data\n\n        this.chatMessages = consult.answers.data.map(answer => {\n          return {\n            id: answer.id,\n            text: answer.content,\n            status: answer.status,\n            yours: consult.writer_id !== answer.writer_id,\n            writer: answer.writer.data,\n            date: answer.date,\n            time: answer.created_at_time\n          }\n        })\n      },\n      setTitle () {\n        return this.title || Vue.i18n.translate('consult.no_title')\n      },\n      back () {\n        this.$router.back()\n      },\n      newMessage (msg) {\n        const data = { text: msg.text, status: msg.status }\n\n        api.put(`consults/${this.$route.params.id}`, data).then(response => {\n            this.init(response.data)\n\n            this.$refs.chatbox.clear()\n          }).catch(error => {\n            this.$store.dispatch('addToastMessage',\n              // { text: Vue.i18n.translate('errors.any'), error }\n              { text: Vue.i18n.translate(`errors.${error.status}`) }\n            )\n          })\n      },\n      updateMessage ({ text, status, updateId }) {\n        const data = { text, status }\n\n        api.put(`consults/${this.$route.params.id}/${updateId}`, data).then(response => {\n            this.init(response.data)\n\n            this.$refs.chatbox.clear()\n          }).catch(error => {\n            this.$store.dispatch('addToastMessage',\n              // { text: Vue.i18n.translate('errors.any'), error }\n              { text: Vue.i18n.translate(`errors.${error.status}`) }\n            )\n          })\n      },\n      deleteMessage (updateId) {        \n        this.$swal({\n          title: 'Are you sure?',\n          text: \"You won't be able to revert this!\",\n          type: 'warning',\n          showCancelButton: true,\n          confirmButtonColor: '#3085d6',\n          cancelButtonColor: '#d33',\n          confirmButtonText: 'Yes, delete it!'\n        }).then((result) => {\n          if (result.value) {   \n            api.post(`consults/${this.$route.params.id}/${updateId}`).then(response => {\n              this.init(response.data)\n\n              this.$refs.chatbox.clear()\n            }).catch(error => {\n              const text = error.data.message ? error.data.message : Vue.i18n.translate(`errors.${error.status}`)\n\n              this.$store.dispatch('addToastMessage', {text})\n            })\n          }\n        })\n      }\n      //update () {\n        // this.$validator.validateAll().then((ult) => {\n        //   if (result) {\n        //     const data = {\n        //       name: this.name,\n        //       email: this.email,\n        //       about: this.about,\n        //       mobile: this.mobile,\n        //       active: this.active,\n        //       family: this.family,\n        //       avatar_id: this.avatar_id\n        //     }\n\n        //     api.put(`consults/${this.id}`, data).then(response => {\n        //       this.$store.dispatch('addToastMessage',\n        //         { text: Vue.i18n.translate('consult.updated'), type: 'success' }\n        //       )\n        //       this.$router.push({ name: 'Consult', params: { id: response.data.id } })\n        //     }).catch(error => {\n        //       this.$store.dispatch('addToastMessage',\n        //         { text: Vue.i18n.translate('errors.any'), error }\n        //       )\n        //       for (let e in error.data.errors) {\n        //         error.data.errors[e].map(text => {\n        //           this.$store.dispatch('addToastMessage',\n        //             { text }\n        //           )\n        //         })\n        //       }\n        //     })\n        //   }\n        // })\n      //}\n    },\n\n    computed: {\n      chatHeight () {\n        const len = this.chatMessages.length\n\n        return (len * 10) + 'rem'\n      }\n    }\n  }\n</script>\n\n<style>\n.vuestic-switch .vuestic-switch-option {\n  padding: 0.313rem 1.375rem !important;\n}\n.form-group.with-icon-right.dropdown.select-form-group {\n  margin-bottom: 0;\n}\n\n.chat-holder {\n  padding: 100px;\n}\n\n.swal2-container.swal2-shown {\n  z-index: 10000;\n}\n\n@media (max-width: 500px) {\n  .chat-holder {\n    padding: 0px;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./update.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./update.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./update.vue?vue&type=template&id=a8a8664e&\"\nimport script from \"./update.vue?vue&type=script&lang=js&\"\nexport * from \"./update.vue?vue&type=script&lang=js&\"\nimport style0 from \"./update.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"update.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./update.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./update.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}